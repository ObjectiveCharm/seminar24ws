import Analyse.pcap_entropy_analyse as pcap_entropy_analyse
import unittest

class PcapEntropyAnalyseTest(unittest.TestCase):
    standard_entropy_result = 3.99512
    test_payload = bytearray(b'00005e8001473c22fbd12ab60800450004d8a4bf00004006fa850a01692553e50fd0c29fffffdb08887d69c2c85780100800a53600000101080a531ffb2ea1218095feb0e4c2ce18e1fe76e674142a8b6f26c9f48ce14cc3beeb973f30b8574d7204819bf948ed3eb2c328fa8f1ed7e3e91b69713555512f97ef0f7f3c05f373e384fff183e019a6a4af330a45cb1b8eb2c7958a4c5371a013c537d62d5ca617351726ce242dd4cdfa62c10059f3158272b954cc21faa53bf71a5c24ade0c409ca0179a18cf17bc2c5a8b76e330fdfb3edb015ed679a1a05cef4b070a9790d699fa3c1809ca71d55aa4569dec9f7b6fe82ad945ca47da7e95d43b7667f6e3985b3dfa737366760be6482f2b70bb50c22c6f3f5386250233f8984ea0126c48180bd3c7c3770c829e23f82a36c95d951e02c2075c113b037fcd9b02f0e0902b6fc74eefadfec34e34f04b8b7757024598ac60fec0b1d7e5cdbe30e82dfc69c08c591c60e75e288290eecc083c414c56e1d6a5813b149f083dc4cf528ccc1bf120c022bd6beb8db15910bac5c630b373aa5cc91c648647d384c76bfbd8bc9d13ebfa0f16bf5d71e803a0fd00fd66ad91db1c9ccf5bf4c3c40d591f53d0cf471ca3196bbd7397c74c2d9fed1ab45fb8ee78f19ee79ad376fd3546721de8212b7090d9de0ac9243ba154112683642186b451584f3f0c0737e0929f02a6da0cdfd3ad403cab7244418509db479d2e1cdd4491a14f9fdfed89327ef8cf44a1d38ae708d076854f90b8ada2104f4dc0527d451c09211865e8bc85c51f689e79e9eff0edbd486f2bac363e69512f892218d8358d3efa3962f4d4ad782d8ac5ee945b659c168472562726b0f6eb896faba601166aae9c617228dfd77f903744f6123b02a20a9590ff52ba55c3b42af745d705adb8f2855b66b84c0bb5fffbd080b45ad6a6332a025775ec5515db9b834278d28aa5e9b7be6496b8b1ed3bcb368924b194f51dd008304ae3e4947112c5c3998a64ee07a7f5d93fe0a4b45dd08b1b9af63f57c6a8d5765d6fc53ab112fac1343bd9b5146efc5c3cba3dd25a6cd87d59e77b5f04f2393d0d4f76d2af53ffa229b0cb47bc55bfe14a7416e29410e36fa282ebc91e4a7aac11d86decf6e5452d255f8f96442a7ef847337dbf9bde420df4726845068dae58f9346bffa43d7e5b7b19c1010f37a98d7842649f8f805f6eed9fddea96da551bbe02dc244fa77e95a8a4eb51d0bb13c59f8b739220d02037f82b28ff10ddacc9721939a5c40f850f05745d6d1ac18a15c75d30dd01e32e8e49e16e9c1a79ba45dfd10489424bb182b0435b147f1170e213e0ffd04ff6f7920b00ef92d8a5cb12ec8869487608978b40cbf675e95363f0fc13943409f90122bb0f94695e5d5556e0997d8442268235989651329fb4464f312da6a51f89cbe55fe29a2804dfbd968a94afa95e263a5fdc9250bbd246116887149efc443fce5d9a511fce4285539866844c60b4d595535b563659fc589e7c870d84ab04fe97e1acaabcf108adb12ed626ccb86913d490706acbd50f2050dd26dc171b81b9945778706a87d51ddb9f96b4c38d4609e034718b6f92044906d244561746477ccf4b80bb844a2dc9e7ef6e8447cdf03e70854c8856494375ff6c045d3d590c9fc104b7083c877914ccf98f7b50df6cd88a079d7e3660350ef3b8a58115dd91ad2d436a9355df067d2f4935279a33d4c85b1100e8f92b8e7a25da6d1ec50a6307125f52cf41702346552d533fd')
    def test_calculate_entropy(self):
        test_result = pcap_entropy_analyse.calculate_entropy_of_data(self.test_payload)
        delta = abs(self.standard_entropy_result - test_result)
        print(f'Test result is {test_result}')
        self.assertLessEqual(delta, 0.1, f"The entropy calculation is not correct with result {test_result}")

if __name__ == '__main__':
    unittest.main()